library(statsr)
library(dplyr)
library(shiny)
library(ggplot2)
data(ames)
ggplot(data = ames, aes(x = area)) +
geom_histogram(binwidth = 250)
ames %>%
summarise(mu = mean(area), pop_med = median(area),
sigma = sd(area), pop_iqr = IQR(area),
pop_min = min(area), pop_max = max(area),
pop_q1 = quantile(area, 0.25),  # first quartile, 25th percentile
pop_q3 = quantile(area, 0.75))  # third quartile, 75th percentile
samp1 <- ames %>%
sample_n(size = 50)
# type your code for the Exercise here, and Run Document
samp1 %>%
summarise(mean = mean(area), samp_med = median(area),
sd = sd(area), samp_iqr = IQR(area),
samp_min = min(area), samp_max = max(area),
samp_q1 = quantile(area, 0.25),  # first quartile, 25th percentile
samp_q3 = quantile(area, 0.75))  # third quartile, 75th percentile
samp1 %>%
summarise(x_bar = mean(area))
ames %>%
sample_n(size = 50) %>%
summarise(x_bar = mean(area))
sample_means50 <- ames %>%
rep_sample_n(size = 50, reps = 15000, replace = TRUE) %>%
summarise(x_bar = mean(area))
ggplot(data = sample_means50, aes(x = x_bar)) +
geom_histogram(binwidth = 20)
# type your code for the Exercise here, and Run Document
sample_means50 %>%
summarise(mean = mean(x_bar), samp_med = median(x_bar),
sd = sd(x_bar), samp_iqr = IQR(x_bar),
samp_min = min(x_bar), samp_max = max(x_bar),
samp_q1 = quantile(x_bar, 0.25),  # first quartile, 25th percentile
samp_q3 = quantile(x_bar, 0.75))  # third quartile, 75th percentile
ames %>%
sample_n(size = 50) %>%
summarise(x_bar = mean(area))
# type your code for the Exercise here, and Run Document
sample_means_small <- ames %>%
rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
summarise(x_bar = mean(area))
ggplot(data = sample_means_small, aes(x = x_bar)) +
geom_histogram(binwidth = 20) +
geom_vline(xintercept=mean(sample_means_small$x_bar), col = 'red')
# type your code for Question 3 here, and Run Document
dim(sample_means_small)[1]
ggplot(data = sample_means50, aes(x = x_bar)) +
geom_histogram(binwidth = 20)
shinyApp(
ui <- fluidPage(
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
selectInput("selected_var",
"Variable:",
choices = list("area", "price"),
selected = "area"),
numericInput("n_samp",
"Sample size:",
min = 1,
max = nrow(ames),
value = 30),
numericInput("n_sim",
"Number of samples:",
min = 1,
max = 30000,
value = 15000)
),
# Show a plot of the generated distribution
mainPanel(
plotOutput("sampling_plot"),
verbatimTextOutput("sampling_mean"),
verbatimTextOutput("sampling_se")
)
)
),
# Define server logic required to draw a histogram
server <- function(input, output) {
# create sampling distribution
sampling_dist <- reactive({
ames[[input$selected_var]] %>%
sample(size = input$n_samp * input$n_sim, replace = TRUE) %>%
matrix(ncol = input$n_samp) %>%
rowMeans() %>%
data.frame(x_bar = .)
#ames %>%
#  rep_sample_n(size = input$n_samp, reps = input$n_sim, replace = TRUE) %>%
#  summarise_(x_bar = mean(input$selected_var))
})
# plot sampling distribution
output$sampling_plot <- renderPlot({
x_min <- quantile(ames[[input$selected_var]], 0.1)
x_max <- quantile(ames[[input$selected_var]], 0.9)
ggplot(sampling_dist(), aes(x = x_bar)) +
geom_histogram() +
xlim(x_min, x_max) +
ylim(0, input$n_sim * 0.35) +
ggtitle(paste0("Sampling distribution of mean ",
input$selected_var, " (n = ", input$n_samp, ")")) +
xlab(paste("mean", input$selected_var)) +
theme(plot.title = element_text(face = "bold", size = 16))
})
# mean of sampling distribution
output$sampling_mean <- renderText({
paste0("mean of sampling distribution = ", round(mean(sampling_dist()$x_bar), 2))
})
# mean of sampling distribution
output$sampling_se <- renderText({
paste0("SE of sampling distribution = ", round(sd(sampling_dist()$x_bar), 2))
})
},
options = list(height = 500)
)
# type your code for this Exercise here, and Run Document
samp1 <- ames %>%
sample_n(size = 50)
# calculate the mean price (point estimate)
mean(samp1$price)
# type your code for this Exercise here, and Run Document
sample_means50 <- ames %>%
rep_sample_n(size = 50, reps = 5000, replace = TRUE) %>%
summarise(x_bar = mean(price))
ggplot(data = sample_means50, aes(x = x_bar)) +
geom_histogram(binwidth = 20) +
geom_vline(xintercept=mean(sample_means50$x_bar), col = 'red')
# type your code for this Exercise here, and Run Document
sample_means150 <- ames %>%
rep_sample_n(size = 150, reps = 5000, replace = TRUE) %>%
summarise(x_bar = mean(price))
ggplot(data = sample_means150, aes(x = x_bar)) +
geom_histogram(binwidth = 20) +
geom_vline(xintercept=mean(sample_means150$x_bar), col = 'red')
# type your code for this Exercise here, and Run Document
# retrieve 15 Samples
samp1 <- ames %>%
sample_n(size = 15)
# calculate the mean price (point estimate)
mean(samp1$price)
# type your code for this Exercise here, and Run Document
sample_means15 <- ames %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
summarise(x_bar = mean(price))
ggplot(data = sample_means15, aes(x = x_bar)) +
geom_histogram(binwidth = 20) +
geom_vline(xintercept=mean(sample_means15$x_bar), col = 'red')
# type your code for this Exercise here, and Run Document
sample_means15 <- ames %>%
rep_sample_n(size = 15, reps = 2000, replace = TRUE) %>%
summarise(x_bar = mean(price))
ggplot(data = sample_means15, aes(x = x_bar)) +
geom_histogram(binwidth = 20) +
geom_vline(xintercept=mean(sample_means15$x_bar), col = 'red')
mean(sample_means15$x_bar)
# type your code for this Exercise here, and Run Document
sample_means150 <- ames %>%
rep_sample_n(size = 150, reps = 2000, replace = TRUE) %>%
summarise(x_bar = mean(price))
ggplot(data = sample_means150, aes(x = x_bar)) +
geom_histogram(binwidth = 20) +
geom_vline(xintercept=mean(sample_means150$x_bar), col = 'red')
mean(sample_means150$x_bar)
set.seed(9102015)                 # make sure to change the seed
library(statsr)
library(dplyr)
library(ggplot2)
data(ames)
n <- 60
samp <- sample_n(ames, n)
# type your code for the Exercise here, and Knit
mean(samp$area)
n <- 60
samp <- sample_n(ames, n)
median(samp$area)
# type your code for the Exercise here, and Knit
mean(samp$area)
median(samp$area)
# histogram
hist(samp$area, col = 'lightgreen', breaks = 20)
abline(v=mean(samp$area), col = 'red')
text(1700, 5.0, "sample\n mean", col = "red")
abline(v=median(samp$area), col = 'blue')
text(1300, 5.0, "sample\n median", col = "blue")
abline(v=population_mean, col = 'darkgreen')
# type your code for the Exercise here, and Knit
mean(samp$area)
median(samp$area)
population_mean <- mean(ames$area)
# histogram
hist(samp$area, col = 'lightgreen', breaks = 20)
abline(v=mean(samp$area), col = 'red')
text(1700, 5.0, "sample\n mean", col = "red")
abline(v=median(samp$area), col = 'blue')
text(1300, 5.0, "sample\n median", col = "blue")
abline(v=population_mean, col = 'darkgreen')
text(1300, 4.0, "population\n mean", col = "darkgreen")
# type your code for the Exercise here, and Knit
mean(samp$area)
median(samp$area)
population_mean <- mean(ames$area)
# histogram
hist(samp$area, col = 'lightgreen', breaks = 20)
abline(v=mean(samp$area), col = 'red')
text(1700, 5.0, "sample\n mean", col = "red")
abline(v=median(samp$area), col = 'blue')
text(1300, 5.0, "sample\n median", col = "blue")
abline(v=population_mean, col = 'darkgreen')
text(1300, 4.0, "population\n mean", col = "darkgreen")
hist(samp$area, col = 'lightgreen', breaks = 20)
abline(v=mean(samp$area), col = 'red')
samp %>%
summarise(lower = mean(area) - z_star_95 * (sd(area) / sqrt(n)),
upper = mean(area) + z_star_95 * (sd(area) / sqrt(n)))
z_star_95 <- qnorm(0.975)
z_star_95
samp %>%
summarise(lower = mean(area) - z_star_95 * (sd(area) / sqrt(n)),
upper = mean(area) + z_star_95 * (sd(area) / sqrt(n)))
params <- ames %>%
summarise(mu = mean(area))
params <- ames %>%
summarise(mu = mean(area))
params
# type your code for the Exercise here, and Knit
params
ci <- ames %>%
rep_sample_n(size = n, reps = 50, replace = TRUE) %>%
summarise(lower = mean(area) - z_star_95 * (sd(area) / sqrt(n)),
upper = mean(area) + z_star_95 * (sd(area) / sqrt(n)))
ci %>%
slice(1:5)
ci <- ci %>%
mutate(capture_mu = ifelse(lower < params$mu & upper > params$mu, "yes", "no"))
ci_data <- data.frame(ci_id = c(1:50, 1:50),
ci_bounds = c(ci$lower, ci$upper),
capture_mu = c(ci$capture_mu, ci$capture_mu))
ggplot(data = ci_data, aes(x = ci_bounds, y = ci_id,
group = ci_id, color = capture_mu)) +
geom_point(size = 2) +  # add points at the ends, size = 2
geom_line() +           # connect with lines
geom_vline(xintercept = params$mu, color = "darkgray") # draw vertical line
# type your code for the Question 5 here, and Knit
z_star_99 <- abs(qnorm((1-0.99)/2))
z_star_99
# type your code for the Exercise here, and Knit
params <- ames %>%
summarise(mu = mean(area))
ci <- ames %>%
rep_sample_n(size = n, reps = 50, replace = TRUE) %>%
summarise(lower = mean(area) - z_star_99 * (sd(area) / sqrt(n)),
upper = mean(area) + z_star_99 * (sd(area) / sqrt(n)))
ci <- ci %>%
mutate(capture_mu = ifelse(lower < params$mu & upper > params$mu, "yes", "no"))
ci_data <- data.frame(ci_id = c(1:50, 1:50),
ci_bounds = c(ci$lower, ci$upper),
capture_mu = c(ci$capture, ci$capture))
# type your code for the Exercise here, and Knit
params <- ames %>%
summarise(mu = mean(area))
ci <- ames %>%
rep_sample_n(size = n, reps = 50, replace = TRUE) %>%
summarise(lower = mean(area) - z_star_99 * (sd(area) / sqrt(n)),
upper = mean(area) + z_star_99 * (sd(area) / sqrt(n)))
ci <- ci %>%
mutate(capture_mu = ifelse(lower < params$mu & upper > params$mu, "yes", "no"))
ci_data <- data.frame(ci_id = c(1:50, 1:50),
ci_bounds = c(ci$lower, ci$upper),
capture_mu = c(ci$capture, ci$capture))
# type your code for the Exercise here, and Knit
ci <- ames %>%
rep_sample_n(size = n, reps = 50, replace = TRUE) %>%
summarise(lower = mean(area) - z_star_99 * (sd(area) / sqrt(n)),
upper = mean(area) + z_star_99 * (sd(area) / sqrt(n)))
ci <- ci %>%
mutate(capture_mu = ifelse(lower < params$mu & upper > params$mu, "yes", "no"))
ci_data <- data.frame(ci_id = c(1:50, 1:50),
ci_bounds = c(ci$lower, ci$upper),
capture_mu = c(ci$capture_mu, ci$capture_mu))
ggplot(data = ci_data, aes(x = ci_bounds, y = ci_id,
group = ci_id, color = capture_mu)) +
geom_point(size = 2) +  # add points at the ends, size = 2
geom_line() +           # connect with lines
geom_vline(xintercept = params$mu, color = "darkgray") # draw vertical line
library(statsr)
library(dplyr)
library(ggplot2)
data(nc)
str(nc)
summary(nc$gained)
# type your code for the Question 3 here, and Knit
nc %>%
group_by(habit) %>%
summarise(mean_weight = mean(weight))
nc %>%
group_by(habit) %>%
summarise(mean_weight = mean(weight))
# type your code for the Question 3 here, and Knit
boxplot(weight ~ habit, data = nc)
inference(y = weight, x = habit, data = nc, statistic = "mean", type = "ht", null = 0,
alternative = "twosided", method = "theoretical")
# type your code for the Question 5 here, and Knit
inference(y = weight, x = habit, data = nc, statistic = "mean", type = "ci",
method = "theoretical", order = c("smoker","nonsmoker"))
inference(y = weight, x = habit, data = nc, statistic = "mean", type = "ht", null = 0,
alternative = "twosided", method = "theoretical")
inference(y = weight, x = habit, data = nc, statistic = "mean", type = "ci",
method = "theoretical", order = c("smoker","nonsmoker"))
# type your code for Question 6 here, and Knit
inference(y = weeks, data = nc, statistic = "mean", type = "ci",
method = "theoretical", conf_level = 0.99)
# type your code for the Exercise here, and Knit
inference(y = weeks, data = nc, statistic = "mean", type = "ci",
method = "theoretical", conf_level = 0.90)
# type your code for the Exercise here, and Knit
inference(y = weight, x = mature, data = nc, statistic = "mean", type = "ci",
method = "theoretical", order = c("mature mom","younger mom"))
# type your code for Question 7 here, and Knit
by(nc$fage, nc$mature, summary)
# type your code for Question 7 here, and Knit
by(nc$fage, nc$mature, summary)
boxplot(nc$fage ~ nc$mature)
# type your code for the Exercise here, and Knit
inference(y = weight, x = whitemom, data = nc, statistic = "mean", type = "ci",
method = "theoretical", order = c("not white","white"))
